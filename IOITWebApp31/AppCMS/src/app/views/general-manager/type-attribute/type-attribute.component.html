<div class="animated fadeIn cms-main">
  <div class="card cms-content">
    <div class="titleCat">
      <h1 class="cms-heading-inline">Danh sách đội nhóm</h1>
      <button class="cms-addnew" type="button" (click)="OpenTypeAttributeModal(undefined)"><i class="fa fa-plus"></i>&nbsp;Thêm mới</button>
    </div>
    <!--<div class="description-page">
      <blockquote class="{{isNoitify ? 'hidden' : ''}}">
        <p>Khu vực hiển thị danh sách các Banner quảng cáo cho các bên thứ 3. Hãy tuân thủ đúng kích thước được đặt cho từng khu vực để banner được hiển thị toàn vẹn nhất</p>
        <a class="close" href="javascript:void(0)" (click)="closeNoityfy()"><span>×</span></a>
      </blockquote>
    </div>-->
    <div class="card-body">
      <div id="DataTables_Table_0_wrapper" class="dataTables_wrapper dt-bootstrap4 no-footer">

        <div class="row cms-filter">
          <div class="col-sm-12 col-md-6" style="padding-left:0px; margin-left: -5px;    display: flex;">
            <ul class="cms-subsubsub">
              <li class="all"><a class="current" aria-current="page">Tất cả <span class="count">({{ paging.item_count }})</span></a> </li>
              <!--<li class="publish"><a>Hiển thị <span class="count">({{ paging.item_count }})</span></a> </li>-->
            </ul>
          </div>
          <div class="col-sm-12 col-md-6" style="display: flex; justify-content: flex-end;align-items: flex-end; padding-right:0">

            <label style="margin-right:10px;display: flex;align-items: center;">
              <span class="search-box">Tìm kiếm</span>
              <input type="text" class="form-control form-control-sm" placeholder="Nhập từ khóa cần tìm...." aria-controls="DataTables_Table_0" [(ngModel)]="q.txtSearch" (keyup.enter)="QueryChanged()">
            </label>

            <div class="dataTables_length" id="DataTables_Table_0_length">
              <label>
                Xem&nbsp;
                <select name="DataTables_Table_0_length" aria-controls="DataTables_Table_0" class="custom-select custom-select-sm form-control form-control-sm" [(ngModel)]="paging.page_size" (change)="GetListTypeAttribute()">
                  <option value="10">10</option>
                  <option value="25">25</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                </select>&nbsp;bản ghi
              </label>
            </div>
          </div>
        </div>
        <div class="row cms-filter action-table">
          <div class="col-sm-6 col-md-3" style="padding-left:0;">
            <ng-select class="mw150-select"
                       [items]="ActionTable"
                       bindLabel="Name"
                       bindValue="Id"
                       [clearable]="true"
                       placeholder="Tác vụ"
                       [(ngModel)]="ActionId"
                       [ngModelOptions]="{standalone: true}">
            </ng-select>
            <button class="cms-addnew button-action" type="button" [disabled]="!ActionId" (click)="ActionTableFunc()">&nbsp;Áp dụng</button>
          </div>
          <div class="col-sm-12 col-md-9">
          </div>
        </div>
        <div class="row content-table-data">
          <div class="col-sm-12">
            <table class="table list-cat table-striped table-bordered datatable dataTable no-footer" id="DataTables_Table_0" role="grid" aria-describedby="DataTables_Table_0_info" style="border-collapse: collapse !important">
              <thead>
                <tr role="row">
                  <th class="btn-action-table" style="width: 5%;">
                    <div class="squaredcheck">
                      <input type="checkbox" class="checkbox1" id="CheckAll" name="CheckAll" [value]="true" (change)="CheckActionTable(undefined)" [(ngModel)]="CheckAll">
                      <label for="CheckAll"><span></span></label>
                    </div>
                  </th>
                  <th>
                    <span [ngClass]="GetClassSortTable('Name')" (click)="SortTable('Name')" class="sortBy">Tên đội nhóm</span>
                  </th>
                  <!--<td class="text-center">
                    Vị Trí
                  </td>
                  <td class="text-center">
                    Hình Ảnh (click xem lớn)
                  </td>
                  <th class="text-center">
                    <span>Kích thước (đề nghị)</span>
                  </th>-->
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of listTypeAttribute; let i = index" role="row" ng-class-odd='odd' ng-class-even='even'>
                  <td class="btn-action-table" style="padding: 0.75rem!important;">
                    <div class="squaredcheck">
                      <input type="checkbox" class="checkbox1" id="Check{{item.TypeAttributeId}}" name="Check{{item.TypeAttributeId}}" [value]="true" [(ngModel)]="item.Action" (change)="CheckActionTable(item.TypeAttributeId)">
                      <label for="Check{{item.TypeAttributeId}}"><span></span></label>
                    </div>
                  </td>
                  <td class="sorting_1 name-child column-name">
                    {{ item.Name }}
                    <ul class="cms-function">
                      <li class="id-item">ID: {{item.TypeAttributeId}} | </li>
                      <li (click)="OpenTypeAttributeModal(item)">Chỉnh sửa<span *ngIf="item.IsDelete==true"> | </span></li>
                      <li (click)="ShowConfirmDelete(item.TypeAttributeId)" class="detete-item" *ngIf="item.IsDelete==true">Xóa</li>
                    </ul>
                  </td>
                  <!--<td class="text-center">
                    {{item.Location}}
                  </td>
                  <td class="text-center">
                    <a href="/assets/img/{{item.Image}}" target="_blank"><img style="max-width:100%;height:40px;" src="../../../../assets/img/{{item.Image}}" /></a>                   
                  </td>
                  <td class="text-center">
                    {{item.Size}}
                  </td>-->
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="row" style="padding-left:15px;">
          <div class="col-sm-12 col-md-5">
            <div *ngIf="paging.item_count > 0" class="dataTables_info" id="DataTables_Table_0_info" role="status" aria-live="polite">
              Hiển thị <span>{{ (paging.page - 1) * paging.page_size + 1 }}</span> <i class="fa fa-long-arrow-right"></i>  <span>{{ paging.item_count < paging.page * paging.page_size ? paging.item_count : paging.page * paging.page_size }}</span>&nbsp;<i class="fa fa-ellipsis-v"></i>&nbsp;<span>{{ paging.item_count }}</span> bản ghi
            </div>
          </div>
          <div class="col-xs-12 col-md-7">
            <pagination [totalItems]="paging.item_count" [(ngModel)]="paging.page" [maxSize]="5" [itemsPerPage]="paging.page_size" class="pagination-sm"
                        previousText="&lsaquo;" nextText="&rsaquo;" [boundaryLinks]="true" (pageChanged)="PageChanged($event)" class="pull-right"></pagination>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div [config]="{backdrop: 'static',  keyboard: false}" bsModal #TypeAttributeModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <form class="login-form">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title" *ngIf="Item.TypeAttributeId == undefined">Thêm mới đội nhóm</h4>
          <h4 class="modal-title" *ngIf="Item.TypeAttributeId != undefined">Sửa thông tin {{this.Item.Name}}</h4>
          <button type="button" class="close" (click)="TypeAttributeModal.hide()" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="card" style="border: none; padding: 15px; margin-bottom: unset;">
            <div class="card-body body-form-add-new">
              <div class="col-sm-12 col-md-12" style="margin:20px 0px;overflow: hidden;">
                <div class="form-group row">
                  <label class="col-md-3 col-form-label" for="Name">Tên đội nhóm<span *ngIf="Item.Name==undefined || Item.Name==''" style="color: red;">&ngsp;(*)</span></label>
                  <div class="col-md-9">
                    <input type="text" id="Name" name="Name" maxlength="200" class="form-control" placeholder="" [(ngModel)]="Item.Name" autocomplete="off">
                  </div>
                </div>
                <div class="form-group row">
                  <label class="col-md-3 col-form-label" for="Name">Trường<span *ngIf="Item.Location==undefined || Item.Location==''" style="color: red;">&ngsp;(*)</span></label>
                  <div class="col-md-9">
                    <ng-select [items]="listSchool" bindLabel="value" bindValue="id"
                        placeholder="Chọn trường" [(ngModel)]="Item.Location" [ngModelOptions]="{standalone: true}">
                    </ng-select>
                  </div>
                </div>
                <div class="form-group row">
                  <label class="col-md-3 col-form-label" for="Name"></label>
                  <div class="col col-sm-8 col-md-8" style="background: #f1f1f1;margin-left: 15px; display: flex;">
                    <div class="w-50">
                      <label class="col-md-3 col-form-label" style="max-width: 125px !important;" for="file-input">Ảnh đại diện</label>
                      <!--<div class="col-md-9" style="padding-top:8px">
                        <a href="javascript:void(0);" id="set-post-thumbnail" class="thickbox" (click)="OpenMediaModal()" style="color: #2271b1; text-decoration: underline; font-size: 14px; font-weight: 400;">Đặt ảnh đại diện</a>
                        <input type="text" name="image" value="" [(ngModel)]="Item.Avata" *ngIf="typeAction!=2" hidden />
                        <div style="font-weight:bold;color:green;display:flex;align-items:center;">
                          <img class="image-upload" *ngIf="Item.Avata != undefined" src="{{staticDomainMedia}}/{{ Item.Avata }}" style="width:90px; height:90px;object-fit:cover;" />
                          <div style="color: red; font-size: 15px; cursor: pointer;margin-left:12px;" (click)="RemoveImage()" *ngIf="Item.Avata != undefined">
                            <i class="fa-duotone fa-trash"></i>
                          </div>
                        </div>
                      </div>-->
                      <div class="col-md-9" style="padding-top:8px">
                        <label class="label-upload" for="upload-photo" style="margin-top:5px;">Tải lên <i class="fa-solid fa-cloud-arrow-up"></i></label>
                        <input #file type="file" (change)="upload(file.files)" id="upload-photo" />
                        <span style="font-weight:bold;color:green;" *ngIf="progress > 0 && progress < 100">
                          {{progress}}%
                        </span>
                      </div>
                    </div>
                    <div class="w-50">
                      <div class="col-md-9" style="padding-top:8px">
                        <div class="block-pev-image">
                          <div class="image-wapper">
                            <img class="image-upload" *ngIf="Item.Image != undefined" src="/images/avatar/{{ Item.Image }}" style="width:150px;height:auto" />
                          </div>
                          <div class="remove-icon-image" (click)="RemoveImage()" *ngIf="Item.Image != undefined">
                            <i class="fa-duotone fa-trash" *ngIf="Item.Image != undefined"></i>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-group row custom-ckeditor" >
                  <label class="col-form-label col-md-12">Nội dung<span *ngIf="Item.Description==''" style="color: red;">&ngsp;(*)</span></label>
                  <div class="col-md-12">
                    <ckeditor name="Contents"
                              [(ngModel)]="Item.Description"
                              [config]=""
                              debounce="500">
                    </ckeditor>
                  </div>
                </div>
              </div>
              <!-- <div class="col-sm-12 col-md-12">
                <div class="form-group row">
                  <label class="col-md-3 col-form-label"></label>
                  <div class="col-md-8" *ngIf="this.Item.TypeAttributeId != undefined">
                    <span style="font-style: italic; color: red;">{{ this.Item.IsUpdate == true ? 'Được phép sửa đội nhóm' : 'Không được phép sửa đội nhóm' }}</span>
                  </div>
                  <div class="col-md-8 squaredcheck" *ngIf="this.Item.TypeAttributeId == undefined">
                    <input type="checkbox" value="None" class="checkbox2" id="IsCreate" name="IsCreate" [value]="true" [(ngModel)]="Item.IsUpdate">
                    <label for="IsCreate"><span>Cho phép sửa đội nhóm</span></label>
                  </div>
                </div>
              </div> -->
              <!-- <div class="col-sm-12 col-md-12">
                <div class="form-group row">
                  <label class="col-md-3 col-form-label"></label>
                  <div class="col-md-8" *ngIf="this.Item.TypeAttributeId != undefined">
                    <span style="font-style: italic; color: red;">{{ this.Item.IsDelete == true ? 'Được phép xóa đội nhóm' : 'Không được phép xóa đội nhóm' }}</span>
                  </div>
                  <div class="col-md-8 squaredcheck" *ngIf="this.Item.TypeAttributeId == undefined">
                    <input type="checkbox" value="None" class="checkbox5" id="IsDelete" name="IsDelete" [disabled]="this.Item.TypeAttributeId != undefined" [value]="true" [(ngModel)]="Item.IsDelete">
                    <label for="IsDelete"><span>Cho phép xóa đội nhóm</span></label>
                  </div>
                </div>
              </div> -->
              <div class="col-sm-12 col-md-12">
                <div class="form-group row">
                  <label class="col-md-3 col-form-label"></label>
                  <div class="dp-flex col-md-8 col-sm-4">
                    <input type="checkbox" name="IsGroup"  [(ngModel)]="Item.IsGroup" [value]="Item.IsGroup"  autocomplete="off"/>
                    <label style="margin-left: 5px; margin-top: 5px;">Top 3 đội nhóm</label>
                 </div>
                </div>
              </div>
              <!---->
              <div class="col-sm-12 col-md-12">
                <div class="col-sm-12 col-md-12">
                  <div class="button-custom">
                    <button class="btn btn-block btn-primary"  (click)="OpenTypeModalModal(undefined)"><i class="fa fa-plus"></i>&nbsp;Thêm thành viên</button>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-12" style="    overflow: hidden;">
                    <table class="table table-striped table-bordered datatable dataTable no-footer" id="DataTables_Table_0" role="grid" aria-describedby="DataTables_Table_0_info" style="border-collapse: collapse !important">
                      <thead style="background: #707070; color:#fff;">
                        <tr role="row">
                          <!--<th style="width: 100px;">Link</th>-->
                          <th style="width: 50px; color:#fff;font-weight:400;" class="text-center">Tên</th>
                          <th style="width: 60px; color: #fff; font-weight: 400;" class="text-center">Mã sinh viên</th>
                          <!--<th style="color: #fff; font-weight: 400; " class="text-center">Banner</th>-->
                          <th style="width: 90px; color: #fff; font-weight: 400;" class="text-center">Thao tác</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let item of this.Item.listCustomer; let idx = index" role="row" ng-class-odd='odd' ng-class-even='even' [hidden]="item.Status == 99">
                          <!--<td class="sorting_1">{{ item.Code }}</td>-->
                          <td class="text-center" style="color: #333 !important; vertical-align: middle;">{{ item.FullName }}</td>
                          <td class="text-center" style="color: #333 !important; vertical-align: middle; ">{{ item.StudentCode }}</td>
                          <!--<td class="text-center" style="vertical-align: middle;">
                            <img *ngIf="item.Image != undefined" src="{{ domainImage }}{{ item.Image }}" alt="logo" style="width: auto;max-width:100%; height: auto; object-fit: contain; max-height:120px;" />
                            <img *ngIf="item.Image == undefined" src="../../../assets/img/no-image1.png" alt="logo" style="width: auto;max-width:100%; height: auto; object-fit: contain; max-height: 120px;" />
                          </td>-->
                          <td style="text-align: center; vertical-align: middle;">
                            <a class="btn btn-info" href="javascript:void(0)" (click)="OpenTypeModalModal(idx)" [hidden]="this.Item.TypeAttributeId != undefined && this.Item.IsUpdate != true">
                              <i class="fa fa-edit"></i>
                            </a>
                            <a class="btn btn-danger" href="javascript:void(0)" (click)="DeleteItem(item.CustomerId)" >
                              <i class="fa fa-trash"></i>
                            </a>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary"  (click)="SaveTypeAttribute()">Lưu thông tin</button>
          <button type="button" class="btn btn-danger" (click)="TypeAttributeModal.hide()">Đóng</button>
        </div>
      </div>
    </form>
  </div>
</div>

<div bsModal #TypeModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="z-index:99999">
  <div class="modal-dialog modal-md" role="document">
    <form class="login-form">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Thêm mới thành viên</h4>
          <button type="button" class="close" (click)="TypeModal.hide()" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="card">
            <div class="card-body body-form-add-new">
              <div class="col-sm-12 col-md-12" style="margin:20px 0px">
                <!--<div class="form-group row">
                  <label class="col-md-4 col-form-label" for="Code">Link</label>
                  <div class="col-md-8">
                    <input type="text" id="Code" name="Code" maxlength="200" class="form-control" placeholder="" [(ngModel)]="newType.Code" autocomplete="off">
                  </div>
                </div>-->
                <div class="form-group row">
                  <label class="col-md-3 col-form-label" for="Name">Trường</label>
                  <div class="col-md-9 disable-sc">
                    <ng-select [items]="listSchool" bindLabel="value" bindValue="id"
                        placeholder="Chọn trường" [(ngModel)]="this.Item.Location" [ngModelOptions]="{standalone: true}">
                    </ng-select>
                  </div>
                </div>
                <div class="form-group row">
                  <label class="col-md-4 col-form-label" for="Location">Chọn thành viên</label>
                  <div class="col-md-8">
                    <ng-select [items]="Users"
                      bindLabel="FullName"
                      bindValue="CustomerId"
                      [multiple]="true"
                      groupBy="selectedAllGroup"
                      [selectableGroup]="true"
                      placeholder="Chọn các thành viên"
                      (change)="onSelectionChange($event)">
                    </ng-select>
                  </div>
                </div>
               </div>
                <!--<div class="form-group row">
                  <label class="col-md-4 col-form-label" for="Description">Mô tả</label>
                  <div class="col-md-8">
                    <input type="text" id="Description" name="Description" class="form-control"  placeholder="" [(ngModel)]="newType.Description" autocomplete="off">
                  </div>
                </div>-->
                <!--<div class="form-group row" style="padding:5px 15px;">
                  <div class="col-md-4" style="padding:0;">
                    <label _ngcontent-c4="" _ngcontent-c3="" class="label-upload" for="upload-photo" style="margin:0;">Tải lên<svg _ngcontent-c4="" _ngcontent-c3="" aria-hidden="true" class="svg-inline--fa fa-cloud-upload-alt fa-w-20" data-icon="cloud-upload-alt" data-prefix="fas" focusable="false" role="img" viewBox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path _ngcontent-c4="" _ngcontent-c3="" class="" d="M537.6 226.6c4.1-10.7 6.4-22.4 6.4-34.6 0-53-43-96-96-96-19.7 0-38.1 6-53.3 16.2C367 64.2 315.3 32 256 32c-88.4 0-160 71.6-160 160 0 2.7.1 5.4.2 8.1C40.2 219.8 0 273.2 0 336c0 79.5 64.5 144 144 144h368c70.7 0 128-57.3 128-128 0-61.9-44-113.6-102.4-125.4zM393.4 288H328v112c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V288h-65.4c-14.3 0-21.4-17.2-11.3-27.3l105.4-105.4c6.2-6.2 16.4-6.2 22.6 0l105.4 105.4c10.1 10.1 2.9 27.3-11.3 27.3z" fill="currentColor"></path></svg></label>
                  </div>
                  <div class="col-md-8" s>
                    <input #fileHeader id="upload-photo" type="file" (change)="upload(fileHeader.files, 1)" value="" />
                    <span style="font-weight:bold;color:green;" *ngIf="progressHeader > 0 && progressHeader < 100">
                      {{progressHeader}}%
                    </span>
                    <span style="font-weight:bold;color:green;">
                      <img class="image-upload img-logo-website" *ngIf="newType.TypeAttributeItemId == undefined && messageHeader" src="{{ domainImage }}{{ messageHeader }}" style="max-height:120px;" />
                      <img class="image-upload img-logo-website" *ngIf="newType.TypeAttributeItemId != undefined && newType.Image != undefined" src="{{ domainImage }}{{ newType.Image }}" style="max-height:120px;" />
                    </span>
                    <i class="fa fa-trash icon-remove-image remove-logo-website" (click)="RemoveImage(1)" *ngIf="(newType.TypeAttributeItemId == undefined && messageHeader) || (newType.TypeAttributeItemId != undefined && newType.Image != undefined)"></i>
                  </div>
                </div>-->
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" appNoDblClickMat (click)="SaveTypeItem()">Lưu</button>
            <button type="button" class="btn btn-danger" (click)="TypeModal.hide()">Đóng</button>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
